<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../favicon.png" />
		<meta name="viewport" content="width=device-width" />
		<meta http-equiv="content-security-policy" content="">
		<link href="../../_app/immutable/assets/0.d7cc313c.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/6.007e7046.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/TocWithPageLink.95cc3c43.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/index.73536a64.css" rel="stylesheet"><!-- HEAD_svelte-1rh24oo_START --><script type="text/javascript">// make toggle sidebar work on `csr = false`
		document.addEventListener('DOMContentLoaded', function () {
			const showTocCheckbox = document.querySelector('input[name="show-toc"]');
			const specViewerEl = document.querySelector('.spec-viewer');
			const sidebarEl = specViewerEl?.querySelector('.sidebar');
			if (showTocCheckbox && specViewerEl && sidebarEl) {
				showTocCheckbox.addEventListener('change', (event) => {
					// show
					if (showTocCheckbox.checked) {
						specViewerEl.attributeStyleMap.set('--sidebar-width', `minmax(250px, 1fr)`);
						sidebarEl.attributeStyleMap.set('display', 'block');
					}
					// hide
					else {
						specViewerEl.attributeStyleMap.set('--sidebar-width', '0');
						sidebarEl.attributeStyleMap.set('display', 'none');
					}
				});
			}
		});
	</script><script type="text/javascript">// observe headings and highlight
		document.addEventListener('DOMContentLoaded', function () {
			const observer = new IntersectionObserver(function observeLastVisibleEntry(entries) {
				const visibleEntries = entries.filter(({ intersectionRatio }) => intersectionRatio !== 0);
				const lastEntry = visibleEntries.slice(1).reduce((lowestEntrySoFar, entry) => {
					if (entry.boundingClientRect.bottom > lowestEntrySoFar.boundingClientRect.bottom) {
						lowestEntrySoFar = entry;
					}
					return lowestEntrySoFar;
				}, visibleEntries[0]);
				if (!lastEntry) return;
				currentHeadingId = lastEntry.target.getAttribute('id');
			});
			const headingEls = articleContentsRef.querySelectorAll('article :is(h1,h2,h3,h4,h5,h6');
			[...headingEls].forEach((el) => {
				observer.observe(el);
			});
		});
	</script><!-- HEAD_svelte-1rh24oo_END -->
	</head>
	<body data-sveltekit-preload-data="hover">
		<div style="display: contents">




<div class="spec-viewer svelte-10tsrky"><nav class="svelte-10tsrky"><div class="gnb-header svelte-y1nqfo"><div class="logo svelte-y1nqfo"><a href="/commonmark-spec-viewer/" class="svelte-y1nqfo">CommonMark Spec Viewer</a>
		<details class="spec-meta svelte-xcrhb3"><summary class="svelte-xcrhb3">Meta</summary>

	<div class="meta svelte-xcrhb3"><pre><code>title: CommonMark Spec
author: John MacFarlane
version: '0.30'
date: '2021-06-19'
license: '[CC-BY-SA 4.0](http://creativecommons.org/licenses/by-sa/4.0/)'</code></pre></div>
</details></div>

	<div class="border svelte-y1nqfo"></div>

	<div class="row svelte-y1nqfo"><div class="left">
				<label title="Show table of contents sidebar" class="svelte-y1nqfo"><input type="checkbox" name="show-toc"> ToC
				</label>
			</div>

		<div class="right svelte-y1nqfo"><a href="./single-page">View as single page</a></div></div>
</div></nav>

	<div class="sidebar svelte-10tsrky" style="display: none;"><div class="svelte-11vpjig"><!-- HTML_TAG_START --><ol>
<li>
<p><a href="./1-introduction">Introduction</a></p>
<ol>
<li><a href="./1-1-what-is-markdown">What is Markdown?</a></li>
<li><a href="./1-2-why-is-a-spec-needed">Why is a spec needed?</a></li>
<li><a href="./1-3-about-this-document">About this document</a></li>
</ol>
</li>
<li>
<p><a href="./2-preliminaries">Preliminaries</a></p>
<ol>
<li><a href="./2-1-characters-and-lines">Characters and lines</a></li>
<li><a href="./2-2-tabs">Tabs</a></li>
<li><a href="./2-3-insecure-characters">Insecure characters</a></li>
<li><a href="./2-4-backslash-escapes">Backslash escapes</a></li>
<li><a href="./2-5-entity-and-numeric-character-references">Entity and numeric character references</a></li>
</ol>
</li>
<li>
<p><a href="./3-blocks-and-inlines">Blocks and inlines</a></p>
<ol>
<li><a href="./3-1-precedence">Precedence</a></li>
<li><a href="./3-2-container-blocks-and-leaf-blocks">Container blocks and leaf blocks</a></li>
</ol>
</li>
<li>
<p><a href="./4-leaf-blocks">Leaf blocks</a></p>
<ol>
<li><a href="./4-1-thematic-breaks">Thematic breaks</a></li>
<li><a href="./4-2-atx-headings">ATX headings</a></li>
<li><a href="./4-3-setext-headings">Setext headings</a></li>
<li><a href="./4-4-indented-code-blocks">Indented code blocks</a></li>
<li><a href="./4-5-fenced-code-blocks">Fenced code blocks</a></li>
<li><a href="./4-6-html-blocks">HTML blocks</a></li>
<li><a href="./4-7-link-reference-definitions">Link reference definitions</a></li>
<li><a href="./4-8-paragraphs">Paragraphs</a></li>
<li><a href="./4-9-blank-lines">Blank lines</a></li>
</ol>
</li>
<li>
<p><a href="./5-container-blocks">Container blocks</a></p>
<ol>
<li>
<p><a href="./5-1-block-quotes">Block quotes</a></p>
</li>
<li>
<p><a href="./5-2-list-items">List items</a></p>
<ol>
<li><a href="./5-2-1-motivation">Motivation</a></li>
</ol>
</li>
<li>
<p><a href="./5-3-lists">Lists</a></p>
</li>
</ol>
</li>
<li>
<p><a href="./6-inlines">Inlines</a></p>
<ol>
<li><a href="./6-1-code-spans">Code spans</a></li>
<li><a href="./6-2-emphasis-and-strong-emphasis">Emphasis and strong emphasis</a></li>
<li><a href="./6-3-links">Links</a></li>
<li><a href="./6-4-images">Images</a></li>
<li><a href="./6-5-autolinks">Autolinks</a></li>
<li><a href="./6-6-raw-html">Raw HTML</a></li>
<li><a href="./6-7-hard-line-breaks">Hard line breaks</a></li>
<li><a href="./6-8-soft-line-breaks">Soft line breaks</a></li>
<li><a href="./6-9-textual-content">Textual content</a></li>
</ol>
</li>
<li>
<p><a href="./7-appendix-a-parsing-strategy">Appendix: A parsing strategy</a></p>
<ol>
<li>
<p><a href="./7-1-overview">Overview</a></p>
</li>
<li>
<p><a href="./7-2-phase-1-block-structure">Phase 1: block structure</a></p>
</li>
<li>
<p><a href="./7-3-phase-2-inline-structure">Phase 2: inline structure</a></p>
<ol>
<li>
<p><a href="./7-3-1-an-algorithm-for-parsing-nested-emphasis-and-links">An algorithm for parsing nested emphasis and links</a></p>
<ol>
<li><a href="./7-3-1-1-look-for-link-or-image"><em>look for link or image</em></a></li>
<li><a href="./7-3-1-2-process-emphasis"><em>process emphasis</em></a></li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
</ol><!-- HTML_TAG_END -->
</div>
	</div>

	<main class="svelte-10tsrky"><div class="contents svelte-10tsrky"><div class="contents2 svelte-ira8jq"><header class="svelte-ira8jq"><nav class="breadcrumb svelte-84fdbx" aria-label="breadcrumb"><ul class="svelte-84fdbx"><li class="svelte-84fdbx"><a href="./toc" aria-current>Spec</a></li>
		
		<li class="svelte-84fdbx"><a href="#article" aria-current="page">1 Introduction</a></li></ul>
</nav>
				<nav data-sveltekit-reload class="svelte-1uzx3u4"><div></div>

	<div>Above:
		<a href="./toc" class="svelte-1uzx3u4">Spec</a></div>

	<div>Next: <a href="./2-preliminaries#preliminaries" class="svelte-1uzx3u4">2 Preliminaries</a></div>
</nav></header>

			<div class="article-contents svelte-ira8jq"><div class="info svelte-c5khnn"><p>Estimated reading time: 6.3 minutes
	</p>
</div>
					<article id="article" class="svelte-lfb1p4"><!-- HTML_TAG_START --><h1 id="introduction">1 Introduction</h1><h2 id="what-is-markdown">1.1 What is Markdown?<a aria-hidden="true" tabindex="-1" href="./1-1-what-is-markdown#what-is-markdown" class="same-host"><span class="icon icon-link"></span></a></h2><p>Markdown is a plain text format for writing structured documents,
based on conventions for indicating formatting in email
and usenet posts.  It was developed by John Gruber (with
help from Aaron Swartz) and released in 2004 in the form of a
<a href="http://daringfireball.net/projects/markdown/syntax" class="external" rel="noopener noreferrer nofollow">syntax description</a>
and a Perl script (<code>Markdown.pl</code>) for converting Markdown to
HTML.  In the next decade, dozens of implementations were
developed in many languages.  Some extended the original
Markdown syntax with conventions for footnotes, tables, and
other document elements.  Some allowed Markdown documents to be
rendered in formats other than HTML.  Websites like Reddit,
StackOverflow, and GitHub had millions of people using Markdown.
And Markdown started to be used beyond the web, to author books,
articles, slide shows, letters, and lecture notes.</p><p>What distinguishes Markdown from many other lightweight markup
syntaxes, which are often easier to write, is its readability.
As Gruber writes:</p><blockquote><p>The overriding design goal for Markdown's formatting syntax is
to make it as readable as possible. The idea is that a
Markdown-formatted document should be publishable as-is, as
plain text, without looking like it's been marked up with tags
or formatting instructions.
(<a href="http://daringfireball.net/projects/markdown/" class="external" rel="noopener noreferrer nofollow">http://daringfireball.net/projects/markdown/</a>)</p></blockquote><p>The point can be illustrated by comparing a sample of
<a href="http://www.methods.co.nz/asciidoc/" class="external" rel="noopener noreferrer nofollow">AsciiDoc</a> with
an equivalent sample of Markdown.  Here is a sample of
AsciiDoc from the AsciiDoc manual:</p><pre><code>1. List item one.
+
List item one continued with a second paragraph followed by an
Indented block.
+
.................
$ ls *.sh
$ mv *.sh ~/tmp
.................
+
List item continued with a third paragraph.

2. List item two continued with an open block.
+
--
This paragraph is part of the preceding list item.

a. This list is nested and does not require explicit item
continuation.
+
This paragraph is part of the preceding list item.

b. List item b.

This paragraph belongs to item two of the outer list.
--
</code></pre><p>And here is the equivalent in Markdown:</p><pre><code>1.  List item one.

    List item one continued with a second paragraph followed by an
    Indented block.

        $ ls *.sh
        $ mv *.sh ~/tmp

    List item continued with a third paragraph.

2.  List item two continued with an open block.

    This paragraph is part of the preceding list item.

    1. This list is nested and does not require explicit item continuation.

       This paragraph is part of the preceding list item.

    2. List item b.

    This paragraph belongs to item two of the outer list.
</code></pre><p>The AsciiDoc version is, arguably, easier to write. You don't need
to worry about indentation.  But the Markdown version is much easier
to read.  The nesting of list items is apparent to the eye in the
source, not just in the processed document.</p><h2 id="why-is-a-spec-needed">1.2 Why is a spec needed?<a aria-hidden="true" tabindex="-1" href="./1-2-why-is-a-spec-needed#why-is-a-spec-needed" class="same-host"><span class="icon icon-link"></span></a></h2><p>John Gruber's <a href="http://daringfireball.net/projects/markdown/syntax" class="external" rel="noopener noreferrer nofollow">canonical description of Markdown's
syntax</a>
does not specify the syntax unambiguously.  Here are some examples of
questions it does not answer:</p><ol><li><p>How much indentation is needed for a sublist?  The spec says that
continuation paragraphs need to be indented four spaces, but is
not fully explicit about sublists.  It is natural to think that
they, too, must be indented four spaces, but <code>Markdown.pl</code> does
not require that.  This is hardly a "corner case," and divergences
between implementations on this issue often lead to surprises for
users in real documents. (See <a href="https://web.archive.org/web/20170611172104/http://article.gmane.org/gmane.text.markdown.general/1997" class="external" rel="noopener noreferrer nofollow">this comment by John
Gruber</a>.)</p></li><li><p>Is a blank line needed before a block quote or heading?
Most implementations do not require the blank line.  However,
this can lead to unexpected results in hard-wrapped text, and
also to ambiguities in parsing (note that some implementations
put the heading inside the blockquote, while others do not).
(John Gruber has also spoken <a href="https://web.archive.org/web/20170611172104/http://article.gmane.org/gmane.text.markdown.general/2146" class="external" rel="noopener noreferrer nofollow">in favor of requiring the blank
lines</a>.)</p></li><li><p>Is a blank line needed before an indented code block?
(<code>Markdown.pl</code> requires it, but this is not mentioned in the
documentation, and some implementations do not require it.)</p><pre><code class="language-markdown">paragraph
    code?
</code></pre></li><li><p>What is the exact rule for determining when list items get
wrapped in <code>&#x3C;p></code> tags?  Can a list be partially "loose" and partially
"tight"?  What should we do with a list like this?</p><pre><code class="language-markdown">1. one

2. two
3. three
</code></pre><p>Or this?</p><pre><code class="language-markdown">1.  one
    - a

    - b
2.  two
</code></pre><p>(There are some relevant comments by John Gruber
<a href="https://web.archive.org/web/20170611172104/http://article.gmane.org/gmane.text.markdown.general/2554" class="external" rel="noopener noreferrer nofollow">here</a>.)</p></li><li><p>Can list markers be indented?  Can ordered list markers be right-aligned?</p><pre><code class="language-markdown"> 8. item 1
 9. item 2
10. item 2a
</code></pre></li><li><p>Is this one list with a thematic break in its second item,
or two lists separated by a thematic break?</p><pre><code class="language-markdown">* a
* * * * *
* b
</code></pre></li><li><p>When list markers change from numbers to bullets, do we have
two lists or one?  (The Markdown syntax description suggests two,
but the perl scripts and many other implementations produce one.)</p><pre><code class="language-markdown">1. fee
2. fie
-  foe
-  fum
</code></pre></li><li><p>What are the precedence rules for the markers of inline structure?
For example, is the following a valid link, or does the code span
take precedence ?</p><pre><code class="language-markdown">[a backtick (`)](/url) and [another backtick (`)](/url).
</code></pre></li><li><p>What are the precedence rules for markers of emphasis and strong
emphasis?  For example, how should the following be parsed?</p><pre><code class="language-markdown">*foo *bar* baz*
</code></pre></li><li><p>What are the precedence rules between block-level and inline-level
structure?  For example, how should the following be parsed?</p><pre><code class="language-markdown">- `a long code span can contain a hyphen like this
  - and it can screw things up`
</code></pre></li><li><p>Can list items include section headings?  (<code>Markdown.pl</code> does not
allow this, but does allow blockquotes to include headings.)</p><pre><code class="language-markdown">- # Heading
</code></pre></li><li><p>Can list items be empty?</p><pre><code class="language-markdown">* a
*
* b
</code></pre></li><li><p>Can link references be defined inside block quotes or list items?</p><pre><code class="language-markdown">> Blockquote [foo].
>
> [foo]: /url
</code></pre></li><li><p>If there are multiple definitions for the same reference, which takes
precedence?</p><pre><code class="language-markdown">[foo]: /url1
[foo]: /url2

[foo][]
</code></pre></li></ol><p>In the absence of a spec, early implementers consulted <code>Markdown.pl</code>
to resolve these ambiguities.  But <code>Markdown.pl</code> was quite buggy, and
gave manifestly bad results in many cases, so it was not a
satisfactory replacement for a spec.</p><p>Because there is no unambiguous spec, implementations have diverged
considerably.  As a result, users are often surprised to find that
a document that renders one way on one system (say, a GitHub wiki)
renders differently on another (say, converting to docbook using
pandoc).  To make matters worse, because nothing in Markdown counts
as a "syntax error," the divergence often isn't discovered right away.</p><h2 id="about-this-document">1.3 About this document<a aria-hidden="true" tabindex="-1" href="./1-3-about-this-document#about-this-document" class="same-host"><span class="icon icon-link"></span></a></h2><p>This document attempts to specify Markdown syntax unambiguously.
It contains many examples with side-by-side Markdown and
HTML.  These are intended to double as conformance tests.  An
accompanying script <code>spec_tests.py</code> can be used to run the tests
against any Markdown program:</p><pre><code>python test/spec_tests.py --spec spec.txt --program PROGRAM
</code></pre><p>Since this document describes how Markdown is to be parsed into
an abstract syntax tree, it would have made sense to use an abstract
representation of the syntax tree instead of HTML.  But HTML is capable
of representing the structural distinctions we need to make, and the
choice of HTML for the tests makes it possible to run the tests against
an implementation without writing an abstract syntax tree renderer.</p><p>Note that not every feature of the HTML samples is mandated by
the spec.  For example, the spec says what counts as a link
destination, but it doesn't mandate that non-ASCII characters in
the URL be percent-encoded.  To use the automatic tests,
implementers will need to provide a renderer that conforms to
the expectations of the spec examples (percent-encoding
non-ASCII characters in URLs).  But a conforming implementation
can use a different renderer and may choose not to
percent-encode non-ASCII characters in URLs.</p><p>This document is generated from a text file, <code>spec.txt</code>, written
in Markdown with a small extension for the side-by-side tests.
The script <code>tools/makespec.py</code> can be used to convert <code>spec.txt</code> into
HTML or CommonMark (which can then be converted into other formats).</p><p>In the examples, the <code>→</code> character is used to represent tabs.</p><!-- HTML_TAG_END -->
</article>

					<aside class="right-sidebar svelte-ira8jq"><nav class="svelte-emiyuh"><!-- HTML_TAG_START --><ul><li><a href="#introduction">1 Introduction</a><ul><li><a href="#what-is-markdown">1.1 What is Markdown?</a></li><li><a href="#why-is-a-spec-needed">1.2 Why is a spec needed?</a></li><li><a href="#about-this-document">1.3 About this document</a></li></ul></li></ul><!-- HTML_TAG_END -->
</nav></aside></div>

			<footer class="svelte-ira8jq"><nav data-sveltekit-reload class="svelte-1uzx3u4"><div></div>

	<div>Above:
		<a href="./toc" class="svelte-1uzx3u4">Spec</a></div>

	<div>Next: <a href="./2-preliminaries#preliminaries" class="svelte-1uzx3u4">2 Preliminaries</a></div>
</nav></footer></div>
	</div></main>

	<footer class="svelte-10tsrky">based on
<a href="https://spec.commonmark.org/" target="_blank" rel="noreferrer noopener">https://spec.commonmark.org/</a>
(try
<a href="https://spec.commonmark.org/dingus/" target="_blank" rel="noreferrer noopener">dingus</a>)</footer>
</div>

</div>
	</body>
</html>
